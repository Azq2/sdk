PROJECT := libm-1.0
TARGET := ANY
BUILD_TYPE := lib
BUILD_DIR := bin

CSTD := -std=c99
OPT := -Os

CFLAGS += -mthumb -fno-gnu89-inline -Wno-implicit-fallthrough -Wno-missing-prototypes
DEFINES += -D__dietlibc__
INCLUDES += -Isrc

LDLIBS += -lcrt_helper -lgcc-4.6.1 -lc-1.0

# reproductive builds
export SOURCE_DATE_EPOCH=1172750400
CFLAGS += -frandom-seed=0

# C sources
CFILES += main.c
CFILES += src/b_exp.c
CFILES += src/b_log.c
CFILES += src/b_tgamma.c
CFILES += src/e_acos.c
CFILES += src/e_acosf.c
CFILES += src/e_acosh.c
CFILES += src/e_acoshf.c
CFILES += src/e_asin.c
CFILES += src/e_asinf.c
CFILES += src/e_atan2.c
CFILES += src/e_atan2f.c
CFILES += src/e_atanh.c
CFILES += src/e_atanhf.c
CFILES += src/e_cosh.c
CFILES += src/e_coshf.c
CFILES += src/e_exp.c
CFILES += src/e_expf.c
CFILES += src/e_fmod.c
CFILES += src/e_fmodf.c
CFILES += src/e_gamma.c
CFILES += src/e_gamma_r.c
CFILES += src/e_gammaf.c
CFILES += src/e_gammaf_r.c
CFILES += src/e_hypot.c
CFILES += src/e_hypotf.c
CFILES += src/e_j0.c
CFILES += src/e_j0f.c
CFILES += src/e_j1.c
CFILES += src/e_j1f.c
CFILES += src/e_jn.c
CFILES += src/e_jnf.c
CFILES += src/e_ldexpf.c
CFILES += src/e_lgamma.c
CFILES += src/e_lgamma_r.c
CFILES += src/e_lgammaf.c
CFILES += src/e_lgammaf_r.c
CFILES += src/e_log.c
CFILES += src/e_log10.c
CFILES += src/e_log10f.c
CFILES += src/e_logf.c
CFILES += src/e_pow.c
CFILES += src/e_powf.c
CFILES += src/e_rem_pio2.c
CFILES += src/e_rem_pio2f.c
CFILES += src/e_remainder.c
CFILES += src/e_remainderf.c
CFILES += src/e_scalb.c
CFILES += src/e_scalbf.c
CFILES += src/e_sinh.c
CFILES += src/e_sinhf.c
CFILES += src/e_sqrt.c
CFILES += src/e_sqrtf.c
CFILES += src/fenv.c
CFILES += src/isinf.c
CFILES += src/k_cos.c
CFILES += src/k_cosf.c
CFILES += src/k_rem_pio2.c
CFILES += src/k_rem_pio2f.c
CFILES += src/k_sin.c
CFILES += src/k_sinf.c
CFILES += src/k_tan.c
CFILES += src/k_tanf.c
CFILES += src/s_asinh.c
CFILES += src/s_asinhf.c
CFILES += src/s_atan.c
CFILES += src/s_atanf.c
CFILES += src/s_cbrt.c
CFILES += src/s_cbrtf.c
CFILES += src/s_ceil.c
CFILES += src/s_ceilf.c
CFILES += src/s_ceill.c
CFILES += src/s_cimag.c
CFILES += src/s_cimagf.c
CFILES += src/s_cimagl.c
CFILES += src/s_conj.c
CFILES += src/s_conjf.c
CFILES += src/s_conjl.c
CFILES += src/s_copysign.c
CFILES += src/s_copysignf.c
CFILES += src/s_copysignl.c
CFILES += src/s_cos.c
CFILES += src/s_cosf.c
CFILES += src/s_creal.c
CFILES += src/s_crealf.c
CFILES += src/s_creall.c
CFILES += src/s_erf.c
CFILES += src/s_erff.c
CFILES += src/s_exp2.c
CFILES += src/s_exp2f.c
CFILES += src/s_expm1.c
CFILES += src/s_expm1f.c
CFILES += src/s_fabs.c
CFILES += src/s_fabsf.c
CFILES += src/s_fabsl.c
CFILES += src/s_fdim.c
CFILES += src/s_finite.c
CFILES += src/s_finitef.c
CFILES += src/s_floor.c
CFILES += src/s_floorf.c
CFILES += src/s_floorl.c
CFILES += src/s_fma.c
CFILES += src/s_fmaf.c
# CFILES += src/s_fmal.c
CFILES += src/s_fmax.c
CFILES += src/s_fmaxf.c
CFILES += src/s_fmaxl.c
CFILES += src/s_fmin.c
CFILES += src/s_fminf.c
CFILES += src/s_fminl.c
CFILES += src/s_frexp.c
CFILES += src/s_frexpf.c
# CFILES += src/s_frexpl.c
CFILES += src/s_ilogb.c
CFILES += src/s_ilogbf.c
CFILES += src/s_ilogbl.c
CFILES += src/s_isfinite.c
CFILES += src/s_isnan.c
CFILES += src/s_isnormal.c
CFILES += src/s_llrint.c
CFILES += src/s_llrintf.c
CFILES += src/s_llround.c
CFILES += src/s_llroundf.c
CFILES += src/s_llroundl.c
CFILES += src/s_log1p.c
CFILES += src/s_log1pf.c
CFILES += src/s_logb.c
CFILES += src/s_logbf.c
CFILES += src/s_lrint.c
CFILES += src/s_lrintf.c
CFILES += src/s_lround.c
CFILES += src/s_lroundf.c
CFILES += src/s_lroundl.c
CFILES += src/s_modf.c
CFILES += src/s_modff.c
CFILES += src/s_nan.c
CFILES += src/s_nearbyint.c
CFILES += src/s_nextafter.c
CFILES += src/s_nextafterf.c
CFILES += src/s_nexttowardf.c
CFILES += src/s_remquo.c
CFILES += src/s_remquof.c
CFILES += src/s_rint.c
CFILES += src/s_rintf.c
CFILES += src/s_round.c
CFILES += src/s_roundf.c
CFILES += src/s_roundl.c
CFILES += src/s_scalbln.c
CFILES += src/s_scalbn.c
CFILES += src/s_scalbnf.c
CFILES += src/s_signbit.c
CFILES += src/s_signgam.c
CFILES += src/s_significand.c
CFILES += src/s_significandf.c
CFILES += src/s_sin.c
CFILES += src/s_sinf.c
CFILES += src/s_tan.c
CFILES += src/s_tanf.c
CFILES += src/s_tanh.c
CFILES += src/s_tanhf.c
CFILES += src/s_tgammaf.c
CFILES += src/s_trunc.c
CFILES += src/s_truncf.c
CFILES += src/s_truncl.c
CFILES += src/w_cabs.c
CFILES += src/w_cabsf.c
CFILES += src/w_drem.c
CFILES += src/w_dremf.c

SIEDEV_DIR=..
include $(SIEDEV_DIR)/rules.mk

install:
	cp -v $(PROJECT).so ../../lib/$(PROJECT).so
